mixin adviceInfo(name, perfectScore, node)
  h3 #{name} (#{node.score})
  button.hidden-small.button-primary(onclick='toggleRow();') Show/hide details
  if node.score < 100
    .responsive
      table
        thead
          tr
            th.text Title
            th.text Advice
            th Score
        tbody    
          each advice, adviceName in node.adviceList
            if advice.score < 100
              tr
                td.text(data-title='Title') #{advice.title} (#{adviceName})
                td.text.url(data-title='Advice') #{advice.advice}
                td(data-title='Score') #{advice.score}
            - if (advice.offending.length > 0)
              tr.text.hideable
                td.url.offendingurl(colspan='3') !{advice.offending.join('<br>')}
  else
    p #{perfectScore}

- const coach = pageInfo.data.coach ? pageInfo.data.coach.run.advice : pageInfo.data.browsertime.page[0].browserScripts[run].coach.coachAdvice.advice;

script(type='text/javascript').
  function toggleRow() {
    var rows = document.getElementsByClassName("hideable");
    for (var i = 0; i < rows.length; ++i) {
      var status = rows[i].currentStyle ? rows[i].currentStyle.display :
                              getComputedStyle(rows[i], null).display;
      rows[i].style.display = (status === 'none') ? "table-row" : "none";
    }
  }

.row
  .column
    a#coach
    .row
      .four.columns
        img.u-max-full-width(src='#{rootPath}/img/coach.png', alt='Im the coach')
      .eight.columns
        h3 Coach score
        ul
          li Total score #{coach.score}
          li Performance score #{coach.performance.score}
          li Accessibility Score #{coach.accessibility.score}
          li Best practice score #{coach.bestpractice.score}
    .row
      .twelve.columns
        +adviceInfo('Accessibility advice','You have a perfect accessibility score!',coach.accessibility)
        
        +adviceInfo('Performance advice','You have a perfect Performance score!',coach.performance)
        
        +adviceInfo('Best practice advice','Your best practice score is perfect!',coach.bestpractice)

        a#info
        h2 Page info
        table
            tr
              td.text Title
              td.text #{coach.info.documentTitle}
            tr
              td.text Width
              td.text #{coach.info.documentWidth}
            tr
              td.text Height
              td.text #{coach.info.documentHeight} 
            tr
              td.text DOM elements
              td.text #{coach.info.domElements}    
            tr
              td.text Avg DOMdepth
              td.text #{coach.info.domDepth.avg}    
            tr
              td.text Max DOM depth
              td.text #{coach.info.domDepth.max}
            tr
              td.text Iframes
              td.text #{coach.info.iframes} 
            tr
              td.text Local storage
              td.text #{h.size.format(coach.info.localStorageSize)} 
            tr
              td.text Session storage
              td.text #{h.size.format(coach.info.sessionStorageSize)}
            tr
              td.text HTML vs AMP
              td.text #{coach.info.amp?'This is an AMP page':'Plain good HTML page'}       
        h3 Resource hints
        table
          each value, key in coach.info.resourceHints
            tr
              td.text #{key}
              td.url !{value.join('<br>')}
